.386
.model FLAT,C
PUBLIC COUNT

.CODE
COUNT PROC
X EQU DWORD PTR[EBP+12]
L EQU DWORD PTR[EBP+8]
  PUSH EBP
  MOV EBP,ESP
  PUSH EBX

  XOR EAX, EAX
  MOV EDI, X
  XOR ECX, ECX
  MOV EDX, L

  MOV EBX, [EDI]
M:
  BT EBX, ECX
  JNC M0
  INC EAX
M0:
  CMP ECX, 31
  JE NWORD
  INC ECX
  DEC EDX
  JNZ M
  JMP FIN
NWORD:
  XOR ECX, ECX
  ADD EDI, 4
  MOV EBX, [EDI]
  JMP M

FIN:
  POP EBX
  POP EBP
  RET 8
COUNT ENDP
END
